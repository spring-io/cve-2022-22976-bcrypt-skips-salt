# BCrypt Hash Check

To assist with the mitigation steps for CVE-2021-xxxx, you can use this tool to check your database for hashes that need updating.

After you've connected the application [to your database](#configuring-for-your-database), the tool works in two steps.

First, you can run the `check` step, like so:

```bash
./mvnw spring-boot:run@check
```

This will check your database for any BCrypt hashes that need updating.

Once you've confirmed that there are hashes that need to be updated, you can run the `update` step, like so:

```bash
./mvnw spring-boot:run@update
```

This will attempt to update any vulnerable hashes it detects. 

### Configuring For Your Database

The tool ships with an in-memory repository for testing purposes.
You will need to replace it with a repository of your own.

One way to do this is to use Spring Data.
You can implement the `PasswordHash` interface like so:

```java
@Entity(name="users")
public class User implements PasswordHash {
	@Id 
	private UUID id;
	
	@Column(name="password")
	private String passwordHash;
	
	public User() {
		
	}
    
	// ... getters and setters
}
```

and then supply a `PasswordHashRepository` like so:

```java
@Repository
public interface UserRepository implements CrudRepository<User, UUID>,
        PasswordHashRepository<User> {}
```

Then update the `application.properties` file with your database connection information.