package org.springframework.security.bcrypt.sample;

import java.util.Map;

import org.springframework.security.bcrypt.check.VulnerabilityCheck;

public class CheckCommand {
	private final Map<Long, String> hashes;
	private final ConsoleCheckView view;

	public CheckCommand(Map<Long, String> hashes, ConsoleCheckView view) {
		this.hashes = hashes;
		this.view = view;
	}

	public void run() {
		boolean anyNeedUpdating = this.hashes.values().stream().anyMatch(VulnerabilityCheck::isHashVulnerable);
		if (anyNeedUpdating) {
			this.view.updatesNeeded();
		} else {
			this.view.noUpdatesNeeded();
		}
	}
}
