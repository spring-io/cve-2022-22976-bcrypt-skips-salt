package org.springframework.security.bcrypt.sample;

import java.util.LinkedHashMap;
import java.util.Map;

import org.springframework.boot.CommandLineRunner;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

@Configuration
public class SampleConfig {
    private final Map<Long, String> hashes = new LinkedHashMap<>();

    public SampleConfig() {
        System.err.printf("\u001b[91m========================================================================\u001b[0m%n");
        System.err.printf("\u001b[91mYou are using the in-memory password sample that ships with this tool.\u001b[0m%n%n");
        System.err.printf("\u001b[91mThat means that 'check' is not actually checking your passwords, and%n'update' is not updating any of your password hashes.\u001b[0m%n%n");
        System.err.printf("\u001b[91mTo check and update your password hashes, please clone this repository and supply your own classes for integrating with your data.\u001b[0m%n");
        System.err.printf("\u001b[91m========================================================================\u001b[0m%n");

        this.hashes.put(1L, "{bcrypt}$2a$31$9N8N35BVs5TLqGL3pspAte5OWWA2a2aZIs.EGp7At7txYakFERMue");
        this.hashes.put(2L, "{bcrypt}$2a$12$EfLupGypIqdNaPvfX3tbuOrokQjUq.u/rMAcRL32bzcqDOZQuSTM6");
        this.hashes.put(3L, "{bcrypt}$2a$10$V0suUo3.5HspfFrtI.C5xuUXnWlNgVtudZB5JbSFMpYvqb4Hlcc0y");
        this.hashes.put(4L, "{bcrypt}$2a$07$.9mDR3QZD.9pPUlLamDlJ.ga6vxG9euUZDTajoMVjLEXPXfSle.ge");
        this.hashes.put(5L, "{pbkdf2}4a9fb8f46d0aac515e5f069f05721712c3ca28d0bbc59a5b778b2505fd8fc565104acf090e3b4f95");
        this.hashes.put(6L, "$2a$31$9N8N35BVs5TLqGL3pspAte5OWWA2a2aZIs.EGp7At7txYakFERMue");
        this.hashes.put(7L, "$2a$12$EfLupGypIqdNaPvfX3tbuOrokQjUq.u/rMAcRL32bzcqDOZQuSTM6");
        this.hashes.put(8L, "$2a$10$V0suUo3.5HspfFrtI.C5xuUXnWlNgVtudZB5JbSFMpYvqb4Hlcc0y");
        this.hashes.put(9L, "$2a$07$.9mDR3QZD.9pPUlLamDlJ.ga6vxG9euUZDTajoMVjLEXPXfSle.ge");
        this.hashes.put(10L, "4a9fb8f46d0aac515e5f069f05721712c3ca28d0bbc59a5b778b2505fd8fc565104acf090e3b4f95");
    }

    @Bean
    CheckCommand check() {
        return new CheckCommand(this.hashes, new ConsoleCheckView());
    }

    @Bean
    UpdateCommand update() {
        return new UpdateCommand(this.hashes, new ConsoleUpdateView());
    }

    @Bean
    CommandLineRunner commands(CheckCommand check, UpdateCommand update) {
        return new Commands(check, update);
    }
}
